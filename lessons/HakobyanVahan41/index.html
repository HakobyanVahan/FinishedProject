<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>

<body>
     <h1>Ընտրեք երկիր</h1>
    <select name="country-select" id="firstSelect" value></select>
    <select name="city-select" id="secondSelect"></select> 

    <!-- <table id="table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Age</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table> -->

    <!-- <form id="form">
        <div class="input_parent">
            <div class="input-div">
                <label>Age *</label>
                <input type="text" name="age" id="age-input" required>
                <div class="warning">This value is wrong!!!</div>
                <div class="valiable">This value is true</div>
            </div>

            <div class="input-div">
                <label>Name *</label>
                <input type="text" name="name" id="name-input" required>
                <div class="warning">This value is wrong!!!</div>
                <div class="valiable">This value is true</div>
            </div>
        </div>

        <div class="input_parent">
            <div class="input-div">
                <label>Emial Address *</label>
                <input type="email" name="emailAddress" id="email-input" required>
                <div class="warning">This value is wrong!!!</div>
                <div class="valiable">This value is true</div>
            </div>

        </div>
        <div class="input_parent">
            <div class="input-div">
                <label>Password *</label>
                <input type="password" name="password" id="password-input" required>
                <div class="warning">This value is wrong!!!</div>
                <div class="valiable">This value is true</div>
            </div>

            <button class="dis-btn" disabled>Save</button>
        </div>
    </form> -->

    <script>
        let firstSelect = document.getElementById('firstSelect');
let secondSelect = document.getElementById('secondSelect');
let i = 0;
let req = new XMLHttpRequest();
req.open('GET', 'http://localhost:3000/country');
req.send();
function request(f) {
    req.onreadystatechange = () => {
        if (req.readyState == 4) {
            f(JSON.parse(req.responseText))
        }
    }
}

request((params) => {
    params.forEach(element => {
        let option = document.createElement('option');
        option.value = i;
        option.innerHTML = `${element.name}`;
        firstSelect.append(option)
        i++
    });

    firstSelect.addEventListener('change', (e) => {
        secondSelect.innerHTML = '';
        let x = params[+e.target.value];
        for (let y in x) {
            if (Array.isArray(x[y])) {
                x[y].forEach(item => {
                    let secondOption = document.createElement('option');
                    secondOption.innerHTML = `${item.name}`;
                    secondSelect.append(secondOption);
                })
            }
        }
    })
})

// let form = document.getElementById('form');
// let ageInput = document.getElementById('age-input');
// let nameInput = document.getElementById('name-input');
// let lastName = document.getElementById('lastName-input');
// let email = document.getElementById('email-input');
// let password = document.getElementById('password-input');
// let btn = document.querySelector('.dis-btn')
// let valiable = document.querySelector('.valiable');
// let warning = document.querySelector('.warning');

// let nameRegExp = /^.{3,}$/;
// let emailRegExp = /^[a-zA-Z0-9_\.\-]+\@[a-zA-Z0-9\-]+\.+[a-zA-Z0-9]{2,4}/;
// let passRegExp = /^.{8,}$/
// let count = 0;

// ageInput.addEventListener('input', e => {
//     const value = e.target.value
//     if (value > 0 && value <= 100) {
//         valiable.style.display = 'block'
//         warning.style.display = 'none';
//         if (count == 0) {
//             count++;
//         }
//     }
//     else {
//         warning.style.display = 'block';
//         valiable.style.display = 'none';
//     }
// })


// nameInput.addEventListener('input', (e) => {
//     if (nameRegExp.test(e.target.value)) {
//         valiable.style.display = 'block'
//         warning.style.display = 'none'

//         if (count == 1) {
//             count++;
//         }
//     } else {
//         warning.style.display = 'block';
//         valiable.style.display = 'none'
//     }
// })

// email.addEventListener('input', (e) => {
//     if (emailRegExp.test(e.target.value)) {
//         valiable.style.display = 'block'
//         warning.style.display = 'none'

//         if (count == 2) {
//             count++;
//         }
//     } else {
//         warning.style.display = 'block';
//         valiable.style.display = 'none'
//     }
// })

// password.addEventListener('input', (e) => {
//     if (passRegExp.test(e.target.value)) {
//         valiable.style.display = 'block'
//         warning.style.display = 'none'

//         if (count == 3) {
//             count++;
//         }
//     } else {
//         warning.style.display = 'block';
//         valiable.style.display = 'none'
//     }

//     if (count == 4) {
//         btn.removeAttribute('disabled');
//     }
// })


// let tbody = document.getElementById('tbody');
// let userReq = new XMLHttpRequest();
// userReq.open('GET', 'http://localhost:3000/users');
// userReq.send();
// function userRequest(cf) {
//     userReq.onreadystatechange = () => {
//         if (userReq.readyState === 4) {
//             cf(JSON.parse(userReq.responseText));
//         }
//     }
// }

// userRequest((user) => {
//     user.forEach(userElem => {
//         let i = userElem.id;
//         tbody.innerHTML +=
//             `
//             <tr>
//             <td>${userElem.name}</td>
//             <td>${userElem.age}</td>
//             <td>${userElem.emailAddress}</td>
//             <td><button class="button" value = ${i}>X</button></td>
//             <td><button class="edit" value = ${i}>✅</button></td>
//           </tr>
//         `;
//     });
//     let deleteButton = document.getElementsByClassName('button');
//     for (let j = 0; j < deleteButton.length; j++) {
//         deleteButton[j].addEventListener('click', (e) => {
//             let delUser = new XMLHttpRequest();
//             delUser.open('DELETE', `http://localhost:3000/users/${+e.target.value}`);
//             delUser.send();

            
//         })
//     };

//     for (let j = 0; j < user.length; j++) {
//         let editButton = document.querySelectorAll('.edit');
//         editButton.forEach(item => {
//             item.addEventListener('click', (e) => {
//                 form.style.display = 'block'
//                 if (user[j].id == e.target.value) {
//                     ageInput.value = user[j].age
//                     nameInput.value = user[j].name
//                     email.value = user[j].emailAddress
//                     password.value = user[j].password
//                     btn.value = e.target.value;
//                 }
//             })
//         })
//     }

//     btn.addEventListener('click', (e) => {
//         e.preventDefault();
//         let putObj = {
//             age: ageInput.value,
//             name: nameInput.value,
//             emailAddress: email.value,
//             password: password.value
//         }

//         let put = new XMLHttpRequest();
//         put.open('PUT', `http://localhost:3000/users/${e.target.value}`);
//         put.setRequestHeader('Content-type', 'application/json');
//         put.send(JSON.stringify(putObj));
//     })
// })

    </script>
</body>

</html>